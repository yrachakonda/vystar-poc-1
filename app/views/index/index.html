<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VyStar OMB Stand-in POC Application</title>
    <link rel="stylesheet" href="styles.css">
    <script
      src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  </head>
  <body>
    <header>
      <!--img src="../../images/logo-vystar-blue.svg" alt="VyStar Credit Union" id="logo"-->
      <!-- Space for company logo -->
      <h1>OMB Stand-in POC Application</h1>
    </header>

    <section>
      <h1>User CRUD</h1>

      <h2>Add User</h2>
      <form action="/users" method="post">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" required>

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required>

        <button type="submit">Add User</button>
      </form>

      <h2>Users</h2>
      <table>
        <tr>
          <th>Name</th>
          <th>Email</th>
          <th>Action</th>
        </tr>
        <% users.forEach(user => { %>
        <tr>
          <td><%= user.name %></td>
          <td><%= user.email %></td>
          <td>
            <form action="/users/delete/<%= user.id %>" method="post"
              style="display:inline;">
              <button type="submit">Delete</button>
            </form>
          </td>
        </tr>
        <% }); %>
      </table>
    </section>
    <section>
      <div class="frame">
        <h1>File Upload</h1>

        <!-- Form for uploading files -->
        <form id='uploadForm'
          action='/upload'
          method='post'
          encType="multipart/form-data">
          <!-- File input field -->
          <input type="file" name="myFile" />
          <!-- Submit button -->
          <input type='button' value='Upload!' id='uploadButton' />
        </form>

        <h2>Uploaded Files</h2>
        <!-- List of uploaded files -->
        <table id="fileList">
          <tr>
            <th>File</th>
          </tr>
          <!-- Files will be added here by the script -->
        </table>
      </div>
    </section>

    <script>
  $(document).ready(function () {
    $('#uploadButton').click(function () {
      var formData = new FormData();
      formData.append('myFile', $('input[type=file]')[0].files[0]);

      $.ajax({
        url: '/upload',
        type: 'POST',
        data: formData,
        processData: false,
        contentType: false,
        success: function (data) {
          alert('File uploaded!');
          refreshFileList();
        },
        error: function () {
          alert('Failed to upload file');
        }
      });
    });

    function refreshFileList() {
      $.get('/files', function (files) {
        $('#fileList').empty();
        $('#fileList').append('<tr><th>File</th></tr>'); // Add header row
        files.forEach(function (file) {
          $('#fileList').append('<tr><td><a href="/download/' + file + '">' + file + '</a></td></tr>');
        });
      });
    }

    refreshFileList();
  });
  </script>

    <footer>
      <br><br>
      Copyright<br>
      &copy; 2024 VyStar Credit Union
    </footer>

  </body>
</html>